#----- install data and env -----
sh prep_data_and_env.sh


#----- one-phase training on ace -----

#train

# graph model
CUDA_VISIBLE_DEVICES=1 python main.py --ensemble=1 --no_rel_name=NO_RELATION --gnn --matrix_trans \
--train_text_1=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bn+nw.json \
--valid_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_dev.json \
--test_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_test.json \
--dataset=ace_2005 --gene_in_data --valid_metric=macro --scheduler=cosine --no_valid \
--loss=loss_1 --t2g_batch_size=8 --t2g_lr=5e-5 --no_rel_weight=0.25 --epoch_numb=30  --warmup_prop=0.02 \
--model_save=model_r1.pkl


#watch
python -m analyze.watch \
--dataset=ace_2005 --gene_no_rel --gene_in_data --no_rel_name=NO_RELATION \
--train_text_1=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bn+nw.json \
--valid_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_dev.json \
--test_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/wl.json \
--watch_type=test --model_save=model_r0.pkl --gene_file=analyze_res/watch/ace2005-cts


#compare
python -m analyze.compare \
--dataset=ace_2005 --gene_no_rel --gene_in_data --no_rel_name=NO_RELATION \
--train_text_1=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bn+nw.json \
--valid_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_dev.json \
--test_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_dev.json \
--watch_type=test --model_save=model_r4.pkl --model_save_2=model_r1.pkl --gene_file=analyze_res/compare/ace2005-bcdev

#----- two-phase training on ace -----

# binary
CUDA_VISIBLE_DEVICES=7 python main.py --ensemble=1 --no_rel_name=NO_RELATION --gnn --matrix_trans \
--train_text_1=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bn+nw.json \
--valid_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_dev.json \
--test_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/wl.json \
--dataset=ace_2005 --gene_in_data --valid_metric=macro --scheduler=cosine --binary --gene_no_rel --no_valid \
--t2g_batch_size=8 --t2g_lr=5e-5 --no_rel_weight=1 --epoch_numb=30 --warmup_prop=0.1 --model_save=binary_r7.pkl

# pos_only
CUDA_VISIBLE_DEVICES=6 python main.py --ensemble=1 --no_rel_name=NO_RELATION --gnn --matrix_trans \
--train_text_1=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bn+nw.json \
--valid_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_dev.json \
--test_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/wl.json \
--dataset=ace_2005 --gene_in_data --valid_metric=macro --scheduler=cosine --pos_only --no_valid \
--t2g_batch_size=8 --t2g_lr=5e-5 --epoch_numb=30  --warmup_prop=0.02 --model_save=psonly_r6.pkl

# watch
python -m analyze.watch \
--dataset=ace_2005 --gene_no_rel --gene_in_data --no_rel_name=NO_RELATION \
--train_text_1=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bn+nw.json \
--valid_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_dev.json \
--test_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_test.json \
--watch_type=test --gene_file=watch/ace2005-cts \
--binary --pos_only  --pos_thresh=0.3 --model_save=binary_r7.pkl --model_save_2=psonly_r1.pkl

#----- two-phase training on ace with matrix transformer -----

# binary
CUDA_VISIBLE_DEVICES=5 python main.py --ensemble=1 --no_rel_name=NO_RELATION \
--train_text_1=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bn+nw.json \
--valid_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_dev.json \
--test_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/wl.json \
--dataset=ace_2005 --gene_in_data --valid_metric=macro --scheduler=cosine --binary --gene_no_rel --no_valid \
--t2g_batch_size=32 --t2g_lr=1e-4 --no_rel_weight=1 --epoch_numb=30  --warmup_prop=0.1 --model_save=binary_r5.pkl

#pos_only
CUDA_VISIBLE_DEVICES=2 python main.py --ensemble=1 --no_rel_name=NO_RELATION \
--train_text_1=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bn+nw.json \
--valid_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/bc_dev.json \
--test_text=./data/ace_2005/ace_05_processed/ace-05-splits/json-pm13/wl.json \
--dataset=ace_2005 --gene_in_data --valid_metric=macro --scheduler=cosine --pos_only \
--t2g_batch_size=32 --t2g_lr=1e-4 --epoch_numb=30  --warmup_prop=0.02 --model_save=psonly_r2.pkl


